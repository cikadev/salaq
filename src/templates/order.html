{% extends "layout.html" %}
{% block body %}
<div class="container">
    <h2 class="is-size-2">Order</h2>
    <div class="columns is-multiline">
        {% for order, product, line, user in orders %}
            <div class="column is-4" id="deliver-order-{{ order.id }}">
                <div class="card">
                    <div class="card-content">
                        <h3 class="is-size-3">
                            Order #{{ order.id }}
                        </h3>
                        <p class="has-text-weight-bold">
                            Product:
                        </p>
                        <p>
                            {{ product.name }}
                        </p>
                        <p class="has-text-weight-bold">
                            Quantity:
                        </p>
                        <p>
                            {{ order.quantity }}
                        </p>
                        <p class="has-text-weight-bold">
                            Receiver Name:
                        </p>
                        <p>
                            {{ user.name }}
                        </p>
                        <p class="has-text-weight-bold">
                            Courrier type:
                        </p>
                        <p>
                            {{ line.courrier_type }}
                        </p>
                        <p class="has-text-weight-bold">
                            Address:
                        </p>
                        <p>
                            {{ line.ship_address }}
                        </p>
                        <p class="has-text-weight-bold">
                            Note:
                        </p>
                        <p>
                            {{ line.note }}
                        </p>
                        <div>
                            <button class="button is-danger" id="deliver-button-{{ order.id }}">Delivered</button>
                        </div>
                    </div>
                </div>
            </div>
            <script type="text/javascript">
                document.querySelector("#deliver-button-{{ order.id }}").addEventListener("click", () => {
                    fetch("/api/deliver/{{ order.id }}")
                    .then((data) => {
                        document.querySelector("#deliver-order-{{ order.id }}").classList.add("is-hidden");
                    })
                    .except((err) => alert(`Error: ${err}`));
                });
            </script>
        {% endfor %}
    </div>
</div>
{% endblock %}